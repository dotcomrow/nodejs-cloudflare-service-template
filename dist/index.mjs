var e={899:(e,t,r)=>{e.exports=r(860)},816:(e,t,r)=>{var s=r(652),n=r(776),i=r(484),o=r(640),a=r(784),l=r(320),c=r(104),u=r(108);e.exports=function(e){return new Promise((function(t,r){var h=e.data,f=e.headers,d=e.responseType;s.isFormData(h)&&delete f["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(m+":"+g)}var y=a(e.baseURL,e.url);function b(){if(p){var s="getAllResponseHeaders"in p?l(p.getAllResponseHeaders()):null,i={data:d&&"text"!==d&&"json"!==d?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:s,config:e,request:p};n(t,r,i),p=null}}if(p.open(e.method.toUpperCase(),o(y,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,"onloadend"in p?p.onloadend=b:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(b)},p.onabort=function(){p&&(r(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){r(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},s.isStandardBrowserEnv()){var w=(e.withCredentials||c(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;w&&(f[e.xsrfHeaderName]=w)}"setRequestHeader"in p&&s.forEach(f,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete f[t]:p.setRequestHeader(t,e)})),s.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),d&&"json"!==d&&(p.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),r(e),p=null)})),h||(h=null),p.send(h)}))}},860:(e,t,r)=>{var s=r(652),n=r(504),i=r(508),o=r(183);function a(e){var t=new i(e),r=n(i.prototype.request,t);return s.extend(r,i.prototype,t),s.extend(r,t),r}var l=a(r(528));l.Axios=i,l.create=function(e){return a(o(l.defaults,e))},l.Cancel=r(432),l.CancelToken=r(312),l.isCancel=r(864),l.all=function(e){return Promise.all(e)},l.spread=r(92),l.isAxiosError=r(288),e.exports=l,e.exports.default=l},432:e=>{function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},312:(e,t,r)=>{var s=r(432);function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new s(e),t(r.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},e.exports=n},864:e=>{e.exports=function(e){return!(!e||!e.__CANCEL__)}},508:(e,t,r)=>{var s=r(652),n=r(640),i=r(747),o=r(88),a=r(183),l=r(984),c=l.validators;function u(e){this.defaults=e,this.interceptors={request:new i,response:new i}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var r=[],s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var n,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!s){var u=[o,void 0];for(Array.prototype.unshift.apply(u,r),u=u.concat(i),n=Promise.resolve(e);u.length;)n=n.then(u.shift(),u.shift());return n}for(var h=e;r.length;){var f=r.shift(),d=r.shift();try{h=f(h)}catch(e){d(e);break}}try{n=o(h)}catch(e){return Promise.reject(e)}for(;i.length;)n=n.then(i.shift(),i.shift());return n},u.prototype.getUri=function(e){return e=a(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},s.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),s.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,s){return this.request(a(s||{},{method:e,url:t,data:r}))}})),e.exports=u},747:(e,t,r)=>{var s=r(652);function n(){this.handlers=[]}n.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){s.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},784:(e,t,r)=>{var s=r(992),n=r(344);e.exports=function(e,t){return e&&!s(t)?n(e,t):t}},108:(e,t,r)=>{var s=r(544);e.exports=function(e,t,r,n,i){var o=new Error(e);return s(o,t,r,n,i)}},88:(e,t,r)=>{var s=r(652),n=r(712),i=r(864),o=r(528);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=n.call(e,e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),s.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=n.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=n.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},544:e=>{e.exports=function(e,t,r,s,n){return e.config=t,r&&(e.code=r),e.request=s,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},183:(e,t,r)=>{var s=r(652);e.exports=function(e,t){t=t||{};var r={},n=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function l(e,t){return s.isPlainObject(e)&&s.isPlainObject(t)?s.merge(e,t):s.isPlainObject(t)?s.merge({},t):s.isArray(t)?t.slice():t}function c(n){s.isUndefined(t[n])?s.isUndefined(e[n])||(r[n]=l(void 0,e[n])):r[n]=l(e[n],t[n])}s.forEach(n,(function(e){s.isUndefined(t[e])||(r[e]=l(void 0,t[e]))})),s.forEach(i,c),s.forEach(o,(function(n){s.isUndefined(t[n])?s.isUndefined(e[n])||(r[n]=l(void 0,e[n])):r[n]=l(void 0,t[n])})),s.forEach(a,(function(s){s in t?r[s]=l(e[s],t[s]):s in e&&(r[s]=l(void 0,e[s]))}));var u=n.concat(i).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return s.forEach(h,c),r}},776:(e,t,r)=>{var s=r(108);e.exports=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(s("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},712:(e,t,r)=>{var s=r(652),n=r(528);e.exports=function(e,t,r){var i=this||n;return s.forEach(r,(function(r){e=r.call(i,e,t)})),e}},528:(e,t,r)=>{var s=r(652),n=r(700),i=r(544),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=r(816)),l),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,r){if(s.isString(e))try{return(0,JSON.parse)(e),s.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||n&&s.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw i(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),s.forEach(["post","put","patch"],(function(e){c.headers[e]=s.merge(o)})),e.exports=c},504:e=>{e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),s=0;s<r.length;s++)r[s]=arguments[s];return e.apply(t,r)}}},640:(e,t,r)=>{var s=r(652);function n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(s.isURLSearchParams(t))i=t.toString();else{var o=[];s.forEach(t,(function(e,t){null!=e&&(s.isArray(e)?t+="[]":e=[e],s.forEach(e,(function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),o.push(n(t)+"="+n(e))})))})),i=o.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},344:e=>{e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},484:(e,t,r)=>{var s=r(652);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,r,n,i,o){var a=[];a.push(e+"="+encodeURIComponent(t)),s.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),s.isString(n)&&a.push("path="+n),s.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},992:e=>{e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},288:e=>{e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},104:(e,t,r)=>{var s=r(652);e.exports=s.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var s=e;return t&&(r.setAttribute("href",s),s=r.href),r.setAttribute("href",s),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=s.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},700:(e,t,r)=>{var s=r(652);e.exports=function(e,t){s.forEach(e,(function(r,s){s!==t&&s.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[s])}))}},320:(e,t,r)=>{var s=r(652),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,o={};return e?(s.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=s.trim(e.substr(0,i)).toLowerCase(),r=s.trim(e.substr(i+1)),t){if(o[t]&&n.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},92:e=>{e.exports=function(e){return function(t){return e.apply(null,t)}}},984:(e,t,r)=>{var s=r(706),n={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){n[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={},o=s.version.split(".");function a(e,t){for(var r=t?t.split("."):o,s=e.split("."),n=0;n<3;n++){if(r[n]>s[n])return!0;if(r[n]<s[n])return!1}return!1}n.transitional=function(e,t,r){var n=t&&a(t);function o(e,t){return"[Axios v"+s.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,s,a){if(!1===e)throw new Error(o(s," has been removed in "+t));return n&&!i[s]&&(i[s]=!0,console.warn(o(s," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,s,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var s=Object.keys(e),n=s.length;n-- >0;){var i=s[n],o=t[i];if(o){var a=e[i],l=void 0===a||o(a,i,e);if(!0!==l)throw new TypeError("option "+i+" must be "+l)}else if(!0!==r)throw Error("Unknown option "+i)}},validators:n}},652:(e,t,r)=>{var s=r(504),n=Object.prototype.toString;function i(e){return"[object Array]"===n.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===n.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:l,isUndefined:o,isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,s){l(t[s])&&l(r)?t[s]=e(t[s],r):l(r)?t[s]=e({},r):i(r)?t[s]=r.slice():t[s]=r}for(var s=0,n=arguments.length;s<n;s++)u(arguments[s],r);return t},extend:function(e,t,r){return u(t,(function(t,n){e[n]=r&&"function"==typeof t?s(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},604:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function a(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=a(r(899)),c=i(r(328));t.default=class{constructor(e,t){this.projectId=e,this.keyFileContent=t,this.token="",this.tokenExpiry=null}base64UrlEncode(e){return Buffer.from(JSON.stringify(e)).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}createJWT(e,t,r){const s=`${this.base64UrlEncode(e)}.${this.base64UrlEncode(t)}`;return`${s}.${c.createSign("RSA-SHA256").update(s).sign(r,"base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}`}getAccessToken(e){return o(this,void 0,void 0,(function*(){if(this.token&&this.tokenExpiry&&this.tokenExpiry>Date.now())return this.token;const t=JSON.parse(this.keyFileContent),r=Math.floor(Date.now()/1e3),s=r+3600,n={iss:t.client_email,sub:t.client_email,scope:e,aud:"https://oauth2.googleapis.com/token",iat:r,exp:s},i=this.createJWT({alg:"RS256",typ:"JWT"},n,t.private_key),o=yield l.default.post("https://oauth2.googleapis.com/token",{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:i});return this.token=o.data.access_token,this.tokenExpiry=1e3*s,this.token}))}}},208:function(e,t,r){var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function a(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(899)),o=n(r(604));t.default=class{constructor(e,t){this.projectId=e,this.keyfile=t,this.token="",this.tokenExpiry=null}logEntry(e,t,r){return s(this,void 0,void 0,(function*(){var s;const n=new o.default(this.projectId,this.keyfile),a=yield n.getAccessToken("https://www.googleapis.com/auth/logging.write"),l={logName:`projects/${this.projectId}/logs/${e}`,resource:{type:"global"},entries:[{severity:t,jsonPayload:{message:r}}]};try{yield i.default.post("https://logging.googleapis.com/v2/entries:write",l,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),console.log(`Logged: ${r}`)}catch(t){console.error(`Error logging to ${e}:`,(null===(s=t.response)||void 0===s?void 0:s.data)||t.message)}}))}}},328:()=>{},706:e=>{e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};(()=>{r.d(s,{c:()=>Kt});const e=Symbol.for("drizzle:entityKind");function t(t,r){if(!t||"object"!=typeof t)return!1;if(t instanceof r)return!0;if(!Object.prototype.hasOwnProperty.call(r,e))throw new Error(`Class "${r.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let s=t.constructor;if(s)for(;s;){if(e in s&&s[e]===r[e])return!0;s=Object.getPrototypeOf(s)}return!1}Symbol.for("drizzle:hasOwnEntityKind");class n{static[e]="ConsoleLogWriter";write(e){console.log(e)}}class i{static[e]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new n}logQuery(e,t){const r=t.map((e=>{try{return JSON.stringify(e)}catch{return String(e)}})),s=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${s}`)}}class o{static[e]="NoopLogger";logQuery(){}}const a=Symbol.for("drizzle:Name"),l=Symbol.for("drizzle:Schema"),c=Symbol.for("drizzle:Columns"),u=Symbol.for("drizzle:OriginalName"),h=Symbol.for("drizzle:BaseName"),f=Symbol.for("drizzle:IsAlias"),d=Symbol.for("drizzle:ExtraConfigBuilder"),p=Symbol.for("drizzle:IsDrizzleTable");class m{static[e]="Table";static Symbol={Name:a,Schema:l,OriginalName:u,Columns:c,BaseName:h,IsAlias:f,ExtraConfigBuilder:d};[a];[u];[l];[c];[h];[f]=!1;[d]=void 0;[p]=!0;constructor(e,t,r){this[a]=this[u]=e,this[l]=t,this[h]=r}}function g(e){return e[a]}class y{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}static[e]="Column";name;primary;notNull;default;defaultFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}}const b=Symbol.for("drizzle:PgInlineForeignKeys");class w extends m{static[e]="PgTable";static Symbol=Object.assign({},m.Symbol,{InlineForeignKeys:b});[b]=[];[m.Symbol.ExtraConfigBuilder]=void 0}class S{static[e]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new v(e,this.columns,this.name)}}class v{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static[e]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[w.Symbol.Name]}_${this.columns.map((e=>e.name)).join("_")}_pk`}}const N=Symbol.for("drizzle:SubqueryConfig");class x{static[e]="Subquery";[N];constructor(e,t,r,s=!1){this[N]={sql:e,selection:t,alias:r,isWith:s}}}class T extends x{static[e]="WithSubquery"}const O=(e,t)=>t(),j=Symbol.for("drizzle:ViewBaseConfig");function $(e){return"object"==typeof e&&null!==e&&"getSQL"in e&&"function"==typeof e.getSQL}class E{static[e]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new A([this])}}class A{constructor(e){this.queryChunks=e}static[e]="SQL";decoder=q;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return O("drizzle.buildSQL",(t=>{const r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r}))}buildQueryFromSourceParams(e,r){const s=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{escapeName:n,escapeParam:i,prepareTyping:o,inlineParams:a,paramStartIndex:l}=s;return function(e){const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}(e.map((e=>{if(t(e,E))return{sql:e.value.join(""),params:[]};if(t(e,C))return{sql:n(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){const t=[new E("(")];for(const[r,s]of e.entries())t.push(s),r<e.length-1&&t.push(new E(", "));return t.push(new E(")")),this.buildQueryFromSourceParams(t,s)}if(t(e,A))return this.buildQueryFromSourceParams(e.queryChunks,{...s,inlineParams:a||e.shouldInlineParams});if(t(e,m)){const t=e[m.Symbol.Schema],r=e[m.Symbol.Name];return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(t(e,y))return{sql:n(e.table[m.Symbol.Name])+"."+n(e.name),params:[]};if(t(e,k)){const t=e[j].schema,r=e[j].name;return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(t(e,_)){const r=null===e.value?null:e.encoder.mapToDriverValue(e.value);if(t(r,A))return this.buildQueryFromSourceParams([r],s);if(a)return{sql:this.mapInlineParam(r,s),params:[]};let n;return void 0!==o&&(n=[o(e.encoder)]),{sql:i(l.value++,r),params:[r],typings:n}}return t(e,R)?{sql:i(l.value++,e),params:[e]}:t(e,A.Aliased)&&void 0!==e.fieldAlias?{sql:n(e.fieldAlias),params:[]}:t(e,x)?e[N].isWith?{sql:n(e[N].alias),params:[]}:this.buildQueryFromSourceParams([new E("("),e[N].sql,new E(") "),new C(e[N].alias)],s):$(e)?this.buildQueryFromSourceParams([new E("("),e.getSQL(),new E(")")],s):t(e,ce)?this.buildQueryFromSourceParams([e.sourceTable,new E("."),P.identifier(e.fieldName)],s):a?{sql:this.mapInlineParam(e,s),params:[]}:{sql:i(l.value++,e),params:[e]}})))}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){const r=e.toString();return t("[object Object]"===r?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new A.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}}class C{constructor(e){this.value=e}static[e]="Name";brand;getSQL(){return new A([this])}}const q={mapFromDriverValue:e=>e},Q={mapToDriverValue:e=>e};class _{constructor(e,t=Q){this.value=e,this.encoder=t}static[e]="Param";brand;getSQL(){return new A([this])}}function P(e,...t){const r=[];(t.length>0||e.length>0&&""!==e[0])&&r.push(new E(e[0]));for(const[s,n]of t.entries())r.push(n,new E(e[s+1]));return new A(r)}var L;(L=P||(P={})).empty=function(){return new A([])},L.fromList=function(e){return new A(e)},L.raw=function(e){return new A([new E(e)])},L.join=function(e,t){const r=[];for(const[s,n]of e.entries())s>0&&void 0!==t&&r.push(t),r.push(n);return new A(r)},L.identifier=function(e){return new C(e)},L.placeholder=function(e){return new R(e)},L.param=function(e,t){return new _(e,t)},(t=>{class r{constructor(e,t){this.sql=e,this.fieldAlias=t}static[e]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new r(this.sql,this.fieldAlias)}}t.Aliased=r})(A||(A={}));class R{constructor(e){this.name=e}static[e]="Placeholder";getSQL(){return new A([this])}}function B(e,r){return e.map((e=>{if(t(e,R)){if(!(e.name in r))throw new Error(`No value for placeholder "${e.name}" was provided`);return r[e.name]}return e}))}class k{static[e]="View";[j];constructor({name:e,schema:t,selectedFields:r,query:s}){this[j]={name:e,originalName:e,schema:t,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new A([this])}}function D(e,r){return!function(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}(r)||$(e)||t(e,_)||t(e,R)||t(e,y)||t(e,m)||t(e,k)?e:new _(e,r)}y.prototype.getSQL=function(){return new A([this])},m.prototype.getSQL=function(){return new A([this])},x.prototype.getSQL=function(){return new A([this])};const z=(e,t)=>P`${e} = ${D(t,e)}`,F=(e,t)=>P`${e} <> ${D(t,e)}`;function I(...e){const t=e.filter((e=>void 0!==e));if(0!==t.length)return 1===t.length?new A(t):new A([new E("("),P.join(t,new E(" and ")),new E(")")])}function M(...e){const t=e.filter((e=>void 0!==e));if(0!==t.length)return 1===t.length?new A(t):new A([new E("("),P.join(t,new E(" or ")),new E(")")])}function U(e){return P`not ${e}`}const K=(e,t)=>P`${e} > ${D(t,e)}`,J=(e,t)=>P`${e} >= ${D(t,e)}`,V=(e,t)=>P`${e} < ${D(t,e)}`,G=(e,t)=>P`${e} <= ${D(t,e)}`;function H(e,t){if(Array.isArray(t)){if(0===t.length)throw new Error("inArray requires at least one value");return P`${e} in ${t.map((t=>D(t,e)))}`}return P`${e} in ${D(t,e)}`}function W(e,t){if(Array.isArray(t)){if(0===t.length)throw new Error("notInArray requires at least one value");return P`${e} not in ${t.map((t=>D(t,e)))}`}return P`${e} not in ${D(t,e)}`}function Y(e){return P`${e} is null`}function X(e){return P`${e} is not null`}function Z(e){return P`exists ${e}`}function ee(e){return P`not exists ${e}`}function te(e,t,r){return P`${e} between ${D(t,e)} and ${D(r,e)}`}function re(e,t,r){return P`${e} not between ${D(t,e)} and ${D(r,e)}`}function se(e,t){return P`${e} like ${t}`}function ne(e,t){return P`${e} not like ${t}`}function ie(e,t){return P`${e} ilike ${t}`}function oe(e,t){return P`${e} not ilike ${t}`}function ae(e){return P`${e} asc`}function le(e){return P`${e} desc`}class ce{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[m.Symbol.Name]}static[e]="Relation";referencedTableName;fieldName}class ue{constructor(e,t){this.table=e,this.config=t}static[e]="Relations"}class he extends ce{constructor(e,t,r,s){super(e,t,r?.relationName),this.config=r,this.isNullable=s}static[e]="One";withFieldName(e){const t=new he(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class fe extends ce{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static[e]="Many";withFieldName(e){const t=new fe(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function de(e){return function(t,r){return new he(e,t,r,r?.fields.reduce(((e,t)=>e&&t.notNull),!0)??!1)}}function pe(e){return function(t,r){return new fe(e,t,r)}}function me(e,r,s){if(t(s,he)&&s.config)return{fields:s.config.fields,references:s.config.references};const n=r[s.referencedTable[m.Symbol.Name]];if(!n)throw new Error(`Table "${s.referencedTable[m.Symbol.Name]}" not found in schema`);const i=e[n];if(!i)throw new Error(`Table "${n}" not found in schema`);const o=s.sourceTable,a=r[o[m.Symbol.Name]];if(!a)throw new Error(`Table "${o[m.Symbol.Name]}" not found in schema`);const l=[];for(const e of Object.values(i.relations))(s.relationName&&s!==e&&e.relationName===s.relationName||!s.relationName&&e.referencedTable===s.sourceTable)&&l.push(e);if(l.length>1)throw s.relationName?new Error(`There are multiple relations with name "${s.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${s.sourceTable[m.Symbol.Name]}". Please specify relation name`);if(l[0]&&t(l[0],he)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw new Error(`There is not enough information to infer relation "${a}.${s.fieldName}"`)}function ge(e){return{one:de(e),many:pe(e)}}function ye(e,r,s,n,i=(e=>e)){const o={};for(const[a,l]of n.entries())if(l.isJson){const n=r.relations[l.tsKey],c=s[a],u="string"==typeof c?JSON.parse(c):c;o[l.tsKey]=t(n,he)?u&&ye(e,e[l.relationTableTsKey],u,l.selection,i):u.map((t=>ye(e,e[l.relationTableTsKey],t,l.selection,i)))}else{const e=i(s[a]),r=l.field;let n;n=t(r,y)?r:t(r,A)?r.decoder:r.sql.decoder,o[l.tsKey]=null===e?null:n.mapFromDriverValue(e)}return o}class be{constructor(e){this.table=e}static[e]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class we{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[e]="TableAliasProxyHandler";get(e,r){if(r===m.Symbol.IsAlias)return!0;if(r===m.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===m.Symbol.OriginalName)return this.alias;if(r===j)return{...e[j],name:this.alias,isAlias:!0};if(r===m.Symbol.Columns){const t=e[m.Symbol.Columns];if(!t)return t;const r={};return Object.keys(t).map((s=>{r[s]=new Proxy(t[s],new be(new Proxy(e,this)))})),r}const s=e[r];return t(s,y)?new Proxy(s,new be(new Proxy(e,this))):s}}function Se(e,t){return new Proxy(e,new we(t,!1))}function ve(e,t){return new Proxy(e,new be(new Proxy(e.table,new we(t,!1))))}function Ne(e,t){return new A.Aliased(xe(e.sql,t),e.fieldAlias)}function xe(e,r){return P.join(e.queryChunks.map((e=>t(e,y)?ve(e,r):t(e,A)?xe(e,r):t(e,A.Aliased)?Ne(e,r):e)))}class Te{static[e]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r===N)return{...e[N],selection:new Proxy(e[N].selection,this)};if(r===j)return{...e[j],selectedFields:new Proxy(e[j].selectedFields,this)};if("symbol"==typeof r)return e[r];const s=(t(e,x)?e[N].selection:t(e,k)?e[j].selectedFields:e)[r];if(t(s,A.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!s.isSelectionField)return s.sql;const e=s.clone();return e.isSelectionField=!0,e}if(t(s,A)){if("sql"===this.config.sqlBehavior)return s;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return t(s,y)?this.config.alias?new Proxy(s,new be(new Proxy(s.table,new we(this.config.alias,this.config.replaceOriginalName??!1)))):s:"object"!=typeof s||null===s?s:new Proxy(s,new Te(this.config))}}class Oe extends Error{static[e]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class je extends Oe{static[e]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}const $e=Symbol.for("drizzle:SQLiteInlineForeignKeys");class Ee extends m{static[e]="SQLiteTable";static Symbol=Object.assign({},m.Symbol,{InlineForeignKeys:$e});[m.Symbol.Columns];[$e]=[];[m.Symbol.ExtraConfigBuilder]=void 0}class Ae extends y{constructor(e,t){t.uniqueName||(t.uniqueName=function(e,t){return`${e[Ee.Symbol.Name]}_${t.join("_")}_unique`}(e,[t.name])),super(e,t),this.table=e}static[e]="SQLiteColumn"}function Ce(e,r,s){const n={},i=e.reduce(((e,{path:i,field:o},a)=>{let l;l=t(o,y)?o:t(o,A)?o.decoder:o.sql.decoder;let c=e;for(const[e,u]of i.entries())if(e<i.length-1)u in c||(c[u]={}),c=c[u];else{const e=r[a],h=c[u]=null===e?null:l.mapFromDriverValue(e);if(s&&t(o,y)&&2===i.length){const e=i[0];e in n?"string"==typeof n[e]&&n[e]!==g(o.table)&&(n[e]=!1):n[e]=null===h&&g(o.table)}}return e}),{});if(s&&Object.keys(n).length>0)for(const[e,t]of Object.entries(n))"string"!=typeof t||s[t]||(i[e]=null);return i}function qe(e,r){return Object.entries(e).reduce(((e,[s,n])=>{if("string"!=typeof s)return e;const i=r?[...r,s]:[s];return t(n,y)||t(n,A)||t(n,A.Aliased)?e.push({path:i,field:n}):t(n,m)?e.push(...qe(n[m.Symbol.Columns],i)):e.push(...qe(n,i)),e}),[])}function Qe(e,t){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(const[e,t]of r.entries())if(t!==s[e])return!1;return!0}function _e(e,r){const s=Object.entries(r).filter((([,e])=>void 0!==e)).map((([r,s])=>t(s,A)?[r,s]:[r,new _(s,e[m.Symbol.Columns][r])]));if(0===s.length)throw new Error("No values to set");return Object.fromEntries(s)}function Pe(e){return t(e,x)?e[N].alias:t(e,k)?e[j].name:t(e,A)?void 0:e[m.Symbol.IsAlias]?e[m.Symbol.Name]:e[m.Symbol.BaseName]}class Le extends k{static[e]="SQLiteViewBase"}class Re{static[e]="SQLiteDialect";escapeName(e){return`"${e}"`}escapeParam(e){return"?"}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildDeleteQuery({table:e,where:t,returning:r}){return P`delete from ${e}${t?P` where ${t}`:void 0}${r?P` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0}`}buildUpdateSet(e,t){const r=Object.entries(t),s=r.length;return P.join(r.flatMap((([t,r],n)=>{const i=e[m.Symbol.Columns][t],o=P`${P.identifier(i.name)} = ${r}`;return n<s-1?[o,P.raw(", ")]:[o]})))}buildUpdateQuery({table:e,set:t,where:r,returning:s}){return P`update ${e} set ${this.buildUpdateSet(e,t)}${r?P` where ${r}`:void 0}${s?P` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0}`}buildSelection(e,{isSingleTable:r=!1}={}){const s=e.length,n=e.flatMap((({field:e},n)=>{const i=[];if(t(e,A.Aliased)&&e.isSelectionField)i.push(P.identifier(e.fieldAlias));else if(t(e,A.Aliased)||t(e,A)){const s=t(e,A.Aliased)?e.sql:e;r?i.push(new A(s.queryChunks.map((e=>t(e,y)?P.identifier(e.name):e)))):i.push(s),t(e,A.Aliased)&&i.push(P` as ${P.identifier(e.fieldAlias)}`)}else if(t(e,y)){const t=e.table[m.Symbol.Name],s=e.name;r?i.push(P.identifier(s)):i.push(P`${P.identifier(t)}.${P.identifier(s)}`)}return n<s-1&&i.push(P`, `),i}));return P.join(n)}buildSelectQuery({withList:e,fields:r,fieldsFlat:s,where:n,having:i,table:o,joins:a,orderBy:l,groupBy:c,limit:u,offset:h,distinct:f,setOperators:d}){const p=s??qe(r);for(const e of p)if(t(e.field,y)&&g(e.field.table)!==(t(o,x)?o[N].alias:t(o,Le)?o[j].name:t(o,A)?void 0:g(o))&&!(e=>a?.some((({alias:t})=>t===(e[m.Symbol.IsAlias]?g(e):e[m.Symbol.BaseName]))))(e.field.table)){const t=g(e.field.table);throw new Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}const b=!a||0===a.length;let w;if(e?.length){const t=[P`with `];for(const[r,s]of e.entries())t.push(P`${P.identifier(s[N].alias)} as (${s[N].sql})`),r<e.length-1&&t.push(P`, `);t.push(P` `),w=P.join(t)}const S=f?P` distinct`:void 0,v=this.buildSelection(p,{isSingleTable:b}),T=t(o,m)&&o[m.Symbol.OriginalName]!==o[m.Symbol.Name]?P`${P.identifier(o[m.Symbol.OriginalName])} ${P.identifier(o[m.Symbol.Name])}`:o,O=[];if(a)for(const[e,r]of a.entries()){0===e&&O.push(P` `);const s=r.table;if(t(s,Ee)){const e=s[Ee.Symbol.Name],t=s[Ee.Symbol.Schema],n=s[Ee.Symbol.OriginalName],i=e===n?void 0:r.alias;O.push(P`${P.raw(r.joinType)} join ${t?P`${P.identifier(t)}.`:void 0}${P.identifier(n)}${i&&P` ${P.identifier(i)}`} on ${r.on}`)}else O.push(P`${P.raw(r.joinType)} join ${s} on ${r.on}`);e<a.length-1&&O.push(P` `)}const $=P.join(O),E=n?P` where ${n}`:void 0,C=i?P` having ${i}`:void 0,q=[];if(l)for(const[e,t]of l.entries())q.push(t),e<l.length-1&&q.push(P`, `);const Q=[];if(c)for(const[e,t]of c.entries())Q.push(t),e<c.length-1&&Q.push(P`, `);const _=Q.length>0?P` group by ${P.join(Q)}`:void 0,L=q.length>0?P` order by ${P.join(q)}`:void 0,R=P`${w}select${S} ${v} from ${T}${$}${E}${_}${C}${L}${u?P` limit ${u}`:void 0}${h?P` offset ${h}`:void 0}`;return d.length>0?this.buildSetOperations(R,d):R}buildSetOperations(e,t){const[r,...s]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return 0===s.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:s,rightSelect:n,limit:i,orderBy:o,offset:a}}){const l=P`${e.getSQL()} `,c=P`${n.getSQL()}`;let u;if(o&&o.length>0){const e=[];for(const r of o)if(t(r,Ae))e.push(P.identifier(r.name));else if(t(r,A)){for(let e=0;e<r.queryChunks.length;e++){const s=r.queryChunks[e];t(s,Ae)&&(r.queryChunks[e]=P.identifier(s.name))}e.push(P`${r}`)}else e.push(P`${r}`);u=P` order by ${P.join(e,P`, `)}`}const h=i?P` limit ${i}`:void 0,f=P.raw(`${r} ${s?"all ":""}`);return P`${l}${f}${c}${u}${h}${a?P` offset ${a}`:void 0}`}buildInsertQuery({table:e,values:r,onConflict:s,returning:n}){const i=[],o=e[m.Symbol.Columns],a=Object.entries(o),l=a.map((([,e])=>P.identifier(e.name)));for(const[e,s]of r.entries()){const n=[];for(const[e,r]of a){const i=s[e];if(void 0===i||t(i,_)&&void 0===i.value){let e;if(null!==r.default&&void 0!==r.default)e=t(r.default,A)?r.default:P.param(r.default,r);else if(void 0!==r.defaultFn){const s=r.defaultFn();e=t(s,A)?s:P.param(s,r)}else e=P`null`;n.push(e)}else n.push(i)}i.push(n),e<r.length-1&&i.push(P`, `)}const c=P.join(i);return P`insert into ${e} ${l} values ${c}${s?P` on conflict ${s}`:void 0}${n?P` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0}`}sqlToQuery(e){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString})}buildRelationalQuery({fullSchema:e,schema:r,tableNamesMap:s,table:n,tableConfig:i,queryConfig:o,tableAlias:a,nestedQueryRelation:l,joinOn:c}){let u,h,f,d=[],p=[];const g=[];if(!0===o)d=Object.entries(i.columns).map((([e,t])=>({dbKey:t.name,tsKey:e,field:ve(t,a),relationTableTsKey:void 0,isJson:!1,selection:[]})));else{const n=Object.fromEntries(Object.entries(i.columns).map((([e,t])=>[e,ve(t,a)])));if(o.where){const e="function"==typeof o.where?o.where(n,{and:I,between:te,eq:z,exists:Z,gt:K,gte:J,ilike:ie,inArray:H,isNull:Y,isNotNull:X,like:se,lt:V,lte:G,ne:F,not:U,notBetween:re,notExists:ee,notLike:ne,notIlike:oe,notInArray:W,or:M,sql:P}):o.where;f=e&&xe(e,a)}const l=[];let c=[];if(o.columns){let e=!1;for(const[t,r]of Object.entries(o.columns))void 0!==r&&t in i.columns&&(e||!0!==r||(e=!0),c.push(t));c.length>0&&(c=e?c.filter((e=>!0===o.columns?.[e])):Object.keys(i.columns).filter((e=>!c.includes(e))))}else c=Object.keys(i.columns);for(const e of c){const t=i.columns[e];l.push({tsKey:e,value:t})}let g,b=[];if(o.with&&(b=Object.entries(o.with).filter((e=>!!e[1])).map((([e,t])=>({tsKey:e,queryConfig:t,relation:i.relations[e]})))),o.extras){g="function"==typeof o.extras?o.extras(n,{sql:P}):o.extras;for(const[e,t]of Object.entries(g))l.push({tsKey:e,value:Ne(t,a)})}for(const{tsKey:e,value:r}of l)d.push({dbKey:t(r,A.Aliased)?r.fieldAlias:i.columns[e].name,tsKey:e,field:t(r,y)?ve(r,a):r,relationTableTsKey:void 0,isJson:!1,selection:[]});let w="function"==typeof o.orderBy?o.orderBy(n,{sql:P,asc:ae,desc:le}):o.orderBy??[];Array.isArray(w)||(w=[w]),p=w.map((e=>t(e,y)?ve(e,a):xe(e,a))),u=o.limit,h=o.offset;for(const{tsKey:n,queryConfig:i,relation:o}of b){const l=me(r,s,o),c=s[o.referencedTable[m.Symbol.Name]],u=`${a}_${n}`,h=I(...l.fields.map(((e,t)=>z(ve(l.references[t],u),ve(e,a))))),f=this.buildRelationalQuery({fullSchema:e,schema:r,tableNamesMap:s,table:e[c],tableConfig:r[c],queryConfig:t(o,he)?!0===i?{limit:1}:{...i,limit:1}:i,tableAlias:u,joinOn:h,nestedQueryRelation:o}),p=P`(${f.sql})`.as(n);d.push({dbKey:n,tsKey:n,field:p,relationTableTsKey:c,isJson:!0,selection:f.selection})}}if(0===d.length)throw new Oe({message:`No fields selected for table "${i.tsName}" ("${a}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});let b;if(f=I(c,f),l){let e=P`json_array(${P.join(d.map((({field:e})=>t(e,Ae)?P.identifier(e.name):t(e,A.Aliased)?e.sql:e)),P`, `)})`;t(l,fe)&&(e=P`coalesce(json_group_array(${e}), json_array())`);const r=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:d}];void 0!==u||void 0!==h||p.length>0?(b=this.buildSelectQuery({table:Se(n,a),fields:{},fieldsFlat:[{path:[],field:P.raw("*")}],where:f,limit:u,offset:h,orderBy:p,setOperators:[]}),f=void 0,u=void 0,h=void 0,p=void 0):b=Se(n,a),b=this.buildSelectQuery({table:t(b,Ee)?b:new x(b,{},a),fields:{},fieldsFlat:r.map((({field:e})=>({path:[],field:t(e,y)?ve(e,a):e}))),joins:g,where:f,limit:u,offset:h,orderBy:p,setOperators:[]})}else b=this.buildSelectQuery({table:Se(n,a),fields:{},fieldsFlat:d.map((({field:e})=>({path:[],field:t(e,y)?ve(e,a):e}))),joins:g,where:f,limit:u,offset:h,orderBy:p,setOperators:[]});return{tableTsKey:i.tsName,sql:b,selection:d}}}class Be extends Re{static[e]="SQLiteSyncDialect";migrate(e,t){const r=P`
			CREATE TABLE IF NOT EXISTS "__drizzle_migrations" (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;t.run(r);const s=t.values(P`SELECT id, hash, created_at FROM "__drizzle_migrations" ORDER BY created_at DESC LIMIT 1`)[0]??void 0;t.run(P`BEGIN`);try{for(const r of e)if(!s||Number(s[2])<r.folderMillis){for(const e of r.sql)t.run(P.raw(e));t.run(P`INSERT INTO "__drizzle_migrations" ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}t.run(P`COMMIT`)}catch(e){throw t.run(P`ROLLBACK`),e}}}class ke extends Re{static[e]="SQLiteAsyncDialect";async migrate(e,t){const r=P`
			CREATE TABLE IF NOT EXISTS "__drizzle_migrations" (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await t.run(r);const s=(await t.values(P`SELECT id, hash, created_at FROM "__drizzle_migrations" ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await t.transaction((async t=>{for(const r of e)if(!s||Number(s[2])<r.folderMillis){for(const e of r.sql)await t.run(P.raw(e));await t.run(P`INSERT INTO "__drizzle_migrations" ("hash", "created_at") VALUES(${r.hash}, ${r.folderMillis})`)}}))}}class De{static[e]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class ze{static[e]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then((t=>(e?.(),t)),(t=>{throw e?.(),t}))}then(e,t){return this.execute().then(e,t)}}class Fe{static[e]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,this.withList=e.withList,this.distinct=e.distinct}from(e){const r=!!this.fields;let s;return s=this.fields?this.fields:t(e,x)?Object.fromEntries(Object.keys(e[N].selection).map((t=>[t,e[t]]))):t(e,Le)?e[j].selectedFields:t(e,A)?{}:e[m.Symbol.Columns],new Me({table:e,fields:s,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class Ie extends De{static[e]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:s,dialect:n,withList:i,distinct:o}){super(),this.config={withList:i,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=r,this.session=s,this.dialect=n,this._={selectedFields:t},this.tableName=Pe(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(r,s)=>{const n=this.tableName,i=Pe(r);if("string"==typeof i&&this.config.joins?.some((e=>e.alias===i)))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof n&&(this.config.fields={[n]:this.config.fields}),"string"==typeof i&&!t(r,A))){const e=t(r,x)?r[N].selection:t(r,k)?r[j].selectedFields:r[m.Symbol.Columns];this.config.fields[i]=e}if("function"==typeof s&&(s=s(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:s,table:r,joinType:e,alias:i}),"string"==typeof i)switch(e){case"left":this.joinsNotNullableMap[i]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([e])=>[e,!1]))),this.joinsNotNullableMap[i]=!0;break;case"inner":this.joinsNotNullableMap[i]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([e])=>[e,!1]))),this.joinsNotNullableMap[i]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{const s="function"==typeof r?r(Ke()):r;if(!Qe(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){const t=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){const t=e[0](new Proxy(this.config.fields,new Te({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{const t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new x(this.getSQL(),this.config.fields,e),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Te({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class Me extends Ie{static[e]="SQLiteSelect";prepare(e){if(!this.session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const t=qe(this.config.fields),r=this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),t,"all");return r.joinsNotNullableMap=this.joinsNotNullableMap,r}run=e=>this.prepare(!0).run(e);all=e=>this.prepare(!0).all(e);get=e=>this.prepare(!0).get(e);values=e=>this.prepare(!0).values(e);async execute(){return this.all()}}function Ue(e,t){return(r,s,...n)=>{const i=[s,...n].map((r=>({type:e,isAll:t,rightSelect:r})));for(const e of i)if(!Qe(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}!function(e,t){for(const r of t)for(const t of Object.getOwnPropertyNames(r.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t)||Object.create(null))}(Me,[ze]);const Ke=()=>({union:Je,unionAll:Ve,intersect:Ge,except:He}),Je=Ue("union",!1),Ve=Ue("union",!0),Ge=Ue("intersect",!1),He=Ue("except",!1);class We{static[e]="SQLiteQueryBuilder";dialect;$with(e){const t=this;return{as:r=>("function"==typeof r&&(r=r(t)),new Proxy(new T(r.getSQL(),r.getSelectedFields(),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){const t=this;return{select:function(r){return new Fe({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(r){return new Fe({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e,distinct:!0})}}}select(e){return new Fe({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Fe({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new Be),this.dialect}}class Ye{constructor(e,t,r){this.table=e,this.session=t,this.dialect=r}static[e]="SQLiteUpdateBuilder";set(e){return new Xe(this.table,_e(this.table,e),this.session,this.dialect)}}class Xe extends ze{constructor(e,t,r,s){super(),this.session=r,this.dialect=s,this.config={set:t,table:e}}static[e]="SQLiteUpdate";config;where(e){return this.config.where=e,this}returning(e=this.config.table[Ee.Symbol.Columns]){return this.config.returning=qe(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(e){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run")}run=e=>this.prepare(!0).run(e);all=e=>this.prepare(!0).all(e);get=e=>this.prepare(!0).get(e);values=e=>this.prepare(!0).values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class Ze{constructor(e,t,r){this.table=e,this.session=t,this.dialect=r}static[e]="SQLiteInsertBuilder";values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw new Error("values() must be called with at least one value");const r=e.map((e=>{const r={},s=this.table[m.Symbol.Columns];for(const n of Object.keys(e)){const i=e[n];r[n]=t(i,A)?i:new _(i,s[n])}return r}));return new et(this.table,r,this.session,this.dialect)}}class et extends ze{constructor(e,t,r,s){super(),this.session=r,this.dialect=s,this.config={table:e,values:t}}static[e]="SQLiteInsert";config;returning(e=this.config.table[Ee.Symbol.Columns]){return this.config.returning=qe(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=P`do nothing`;else{const t=Array.isArray(e.target)?P`${e.target}`:P`${[e.target]}`,r=e.where?P` where ${e.where}`:P``;this.config.onConflict=P`${t} do nothing${r}`}return this}onConflictDoUpdate(e){const t=Array.isArray(e.target)?P`${e.target}`:P`${[e.target]}`,r=e.where?P` where ${e.where}`:P``,s=this.dialect.buildUpdateSet(this.config.table,_e(this.config.table,e.set));return this.config.onConflict=P`${t} do update set ${s}${r}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(e){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run")}run=e=>this.prepare(!0).run(e);all=e=>this.prepare(!0).all(e);get=e=>this.prepare(!0).get(e);values=e=>this.prepare(!0).values(e);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class tt extends ze{constructor(e,t,r){super(),this.table=e,this.session=t,this.dialect=r,this.config={table:e}}static[e]="SQLiteDelete";config;where(e){return this.config.where=e,this}returning(e=this.table[Ee.Symbol.Columns]){return this.config.returning=qe(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}prepare(e){return this.session[e?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run")}run=e=>this.prepare(!0).run(e);all=e=>this.prepare(!0).all(e);get=e=>this.prepare(!0).get(e);values=e=>this.prepare(!0).values(e);async execute(e){return this.prepare(!0).execute(e)}$dynamic(){return this}}class rt{constructor(e,t,r,s,n,i,o,a){this.mode=e,this.fullSchema=t,this.schema=r,this.tableNamesMap=s,this.table=n,this.tableConfig=i,this.dialect=o,this.session=a}static[e]="SQLiteAsyncRelationalQueryBuilder";findMany(e){return"sync"===this.mode?new nt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many"):new st(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return"sync"===this.mode?new nt(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first"):new st(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class st extends ze{constructor(e,t,r,s,n,i,o,a,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=s,this.tableConfig=n,this.dialect=i,this.session=o,this.config=a,this.mode=l}static[e]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}prepare(){const{query:e,builtQuery:t}=this._toSQL();return this.session.prepareQuery(t,void 0,"first"===this.mode?"get":"all",((t,r)=>{const s=t.map((t=>ye(this.schema,this.tableConfig,t,e.selection,r)));return"first"===this.mode?s[0]:s}))}_toSQL(){const e=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName});return{query:e,builtQuery:this.dialect.sqlToQuery(e.sql)}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this.prepare().get():this.prepare().all()}async execute(){return this.executeRaw()}}class nt extends st{static[e]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}class it extends ze{constructor(e,t,r,s,n){super(),this.cb=e,this.getSQLCb=t,this.dialect=s,this.mapBatchResult=n,this.config={action:r}}static[e]="SQLiteRaw";config;getSQL(){return this.getSQLCb()}async execute(){return this.cb()}prepare(){return{getQuery:()=>this.dialect.sqlToQuery(this.getSQL()),mapResult:(e,t)=>t?this.mapBatchResult(e):e}}}class ot{constructor(e,t,r,s){if(this.resultKind=e,this.dialect=t,this.session=r,this._=s?{schema:s.schema,tableNamesMap:s.tableNamesMap}:{schema:void 0,tableNamesMap:{}},this.query={},this._.schema)for(const[n,i]of Object.entries(this._.schema))this.query[n]=new rt(e,s.fullSchema,this._.schema,this._.tableNamesMap,s.fullSchema[n],i,t,r)}static[e]="BaseSQLiteDatabase";query;$with(e){return{as:t=>("function"==typeof t&&(t=t(new We)),new Proxy(new T(t.getSQL(),t.getSelectedFields(),e,!0),new Te({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){const t=this;return{select:function(r){return new Fe({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new Fe({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}}}select(e){return new Fe({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Fe({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(e){return new Ye(e,this.session,this.dialect)}insert(e){return new Ze(e,this.session,this.dialect)}delete(e){return new tt(e,this.session,this.dialect)}run(e){const t=e.getSQL();return"async"===this.resultKind?new it((async()=>this.session.run(t)),(()=>t),"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(t)}all(e){const t=e.getSQL();return"async"===this.resultKind?new it((async()=>this.session.all(t)),(()=>t),"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(t)}get(e){const t=e.getSQL();return"async"===this.resultKind?new it((async()=>this.session.get(t)),(()=>t),"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(t)}values(e){const t=e.getSQL();return"async"===this.resultKind?new it((async()=>this.session.values(t)),(()=>t),"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(t)}transaction(e,t){return this.session.transaction(e,t)}}class at extends ze{constructor(e){super(),this.resultCb=e}static[e]="ExecuteResultSync";async execute(){return this.resultCb()}sync(){return this.resultCb()}}class lt{constructor(e,t,r){this.mode=e,this.executeMethod=t,this.query=r}static[e]="PreparedQuery";joinsNotNullableMap;getQuery(){return this.query}mapRunResult(e,t){return e}mapAllResult(e,t){throw new Error("Not implemented")}mapGetResult(e,t){throw new Error("Not implemented")}execute(e){return"async"===this.mode?this[this.executeMethod](e):new at((()=>this[this.executeMethod](e)))}mapResult(e,t){switch(this.executeMethod){case"run":return this.mapRunResult(e,t);case"all":return this.mapAllResult(e,t);case"get":return this.mapGetResult(e,t)}}}class ct{constructor(e){this.dialect=e}static[e]="SQLiteSession";prepareOneTimeQuery(e,t,r){return this.prepareQuery(e,t,r)}run(e){const t=this.dialect.sqlToQuery(e);try{return this.prepareOneTimeQuery(t,void 0,"run").run()}catch(e){throw new Oe({cause:e,message:`Failed to run the query '${t.sql}'`})}}extractRawRunValueFromBatchResult(e){return e}all(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run").all()}extractRawAllValueFromBatchResult(e){throw new Error("Not implemented")}get(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run").get()}extractRawGetValueFromBatchResult(e){throw new Error("Not implemented")}values(e){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(e),void 0,"run").values()}extractRawValuesValueFromBatchResult(e){throw new Error("Not implemented")}}class ut extends ot{constructor(e,t,r,s,n=0){super(e,t,r,s),this.schema=s,this.nestedIndex=n}static[e]="SQLiteTransaction";rollback(){throw new je}}class ht extends ct{constructor(e,t,r,s={}){super(t),this.client=e,this.schema=r,this.options=s,this.logger=s.logger??new o}static[e]="SQLiteD1Session";logger;prepareQuery(e,t,r,s){const n=this.client.prepare(e.sql);return new pt(n,e,this.logger,t,r,s)}async batch(e){const t=[],r=[];for(const s of e){const e=s.prepare(),n=e.getQuery();if(t.push(e),n.params.length>0)r.push(e.stmt.bind(...n.params));else{const t=e.getQuery();r.push(this.client.prepare(t.sql).bind(...t.params))}}return(await this.client.batch(r)).map(((e,r)=>t[r].mapResult(e,!0)))}extractRawAllValueFromBatchResult(e){return e.results}extractRawGetValueFromBatchResult(e){return e.results[0]}extractRawValuesValueFromBatchResult(e){return dt(e.results)}async transaction(e,t){const r=new ft("async",this.dialect,this,this.schema);await this.run(P.raw("begin"+(t?.behavior?" "+t.behavior:"")));try{const t=await e(r);return await this.run(P`commit`),t}catch(e){throw await this.run(P`rollback`),e}}}class ft extends ut{static[e]="D1Transaction";async transaction(e){const t=`sp${this.nestedIndex}`,r=new ft("async",this.dialect,this.session,this.schema,this.nestedIndex+1);await this.session.run(P.raw(`savepoint ${t}`));try{const s=await e(r);return await this.session.run(P.raw(`release savepoint ${t}`)),s}catch(e){throw await this.session.run(P.raw(`rollback to savepoint ${t}`)),e}}}function dt(e){const t=[];for(const r of e){const e=Object.keys(r).map((e=>r[e]));t.push(e)}return t}class pt extends lt{constructor(e,t,r,s,n,i){super("async",n,t),this.logger=r,this.customResultMapper=i,this.fields=s,this.stmt=e}static[e]="D1PreparedQuery";customResultMapper;fields;stmt;run(e){const t=B(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),this.stmt.bind(...t).run()}async all(e){const{fields:t,query:r,logger:s,stmt:n,customResultMapper:i}=this;if(!t&&!i){const t=B(r.params,e??{});return s.logQuery(r.sql,t),n.bind(...t).all().then((({results:e})=>this.mapAllResult(e)))}const o=await this.values(e);return this.mapAllResult(o)}mapAllResult(e,t){return t&&(e=dt(e.results)),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper(e):e.map((e=>Ce(this.fields,e,this.joinsNotNullableMap))):e}async get(e){const{fields:t,joinsNotNullableMap:r,query:s,logger:n,stmt:i,customResultMapper:o}=this;if(!t&&!o){const t=B(s.params,e??{});return n.logQuery(s.sql,t),i.bind(...t).all().then((({results:e})=>e[0]))}const a=await this.values(e);if(a[0])return o?o(a):Ce(t,a[0],r)}mapGetResult(e,t){return t&&(e=dt(e.results)[0]),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper([e]):Ce(this.fields,e,this.joinsNotNullableMap):e}values(e){const t=B(this.query.params,e??{});return this.logger.logQuery(this.query.sql,t),this.stmt.bind(...t).raw()}}class mt extends ot{static[e]="LibSQLDatabase";async batch(e){return this.session.batch(e)}}function gt(e,r={}){const s=new ke;let n,o;if(!0===r.logger?n=new i:!1!==r.logger&&(n=r.logger),r.schema){const e=function(e,r){1===Object.keys(e).length&&"default"in e&&!t(e.default,m)&&(e=e.default);const s={},n={},i={};for(const[a,l]of Object.entries(e))if("object"==typeof(o=l)&&null!==o&&p in o){const e=l[m.Symbol.Name],r=n[e];s[e]=a,i[a]={tsName:a,dbName:l[m.Symbol.Name],schema:l[m.Symbol.Schema],columns:l[m.Symbol.Columns],relations:r?.relations??{},primaryKey:r?.primaryKey??[]};for(const e of Object.values(l[m.Symbol.Columns]))e.primary&&i[a].primaryKey.push(e);const o=l[m.Symbol.ExtraConfigBuilder]?.(l);if(o)for(const e of Object.values(o))t(e,S)&&i[a].primaryKey.push(...e.columns)}else if(t(l,ue)){const e=l.table[m.Symbol.Name],t=s[e],o=l.config(r(l.table));let a;for(const[r,s]of Object.entries(o))if(t){const e=i[t];e.relations[r]=s,a&&e.primaryKey.push(...a)}else e in n||(n[e]={relations:{},primaryKey:a}),n[e].relations[r]=s}var o;return{tables:i,tableNamesMap:s}}(r.schema,ge);o={fullSchema:r.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}const a=new ht(e,s,o,{logger:n});return new mt("async",s,a,o)}async function yt(e,t,r){var s={};if(r){var n=await fetch(e.USER_PROFILE_SVC_URL,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r}}),i=JSON.parse(await n.text());s.groups=i.groups}const o=gt(e.user_prefs_database);if(0==(a=await e.user_prefs_database.prepare("select * from user_preferences where account_id = ?").bind(t).all()).results.length){await o.insert(user_preferences).values({account_id:t,preferences:{},last_update_datetime:new Date}).run();var a=await e.user_prefs_database.prepare("select * from user_preferences where account_id = ?").bind(t).all();return s.preferences=a.results[0],s.account_id=a.results[0].account_id,s}return s.preferences=a.results[0],s.account_id=a.results[0].account_id,s}class bt{static[e]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}}class wt{static[e]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{const{name:t,columns:r,foreignColumns:s}=e();return{name:t,columns:r,foreignTable:s[0].table,foreignColumns:s}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new St(e,this)}}class St{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[e]="PgForeignKey";reference;onUpdate;onDelete;getName(){const{name:e,columns:t,foreignColumns:r}=this.reference(),s=t.map((e=>e.name)),n=r.map((e=>e.name)),i=[this.table[w.Symbol.Name],...s,r[0].table[w.Symbol.Name],...n];return e??`${i.join("_")}_fk`}}function vt(e,t,r){for(let s=t;s<e.length;s++){const n=e[s];if("\\"!==n){if('"'===n)return[e.slice(t,s).replace(/\\/g,""),s+1];if(!r&&(","===n||"}"===n))return[e.slice(t,s).replace(/\\/g,""),s]}else s++}return[e.slice(t).replace(/\\/g,""),e.length]}function Nt(e,t=0){const r=[];let s=t,n=!1;for(;s<e.length;){const i=e[s];if(","===i){(n||s===t)&&r.push(""),n=!0,s++;continue}if(n=!1,"\\"===i){s+=2;continue}if('"'===i){const[t,n]=vt(e,s+1,!0);r.push(t),s=n;continue}if("}"===i)return[r,s+1];if("{"===i){const[t,n]=Nt(e,s+1);r.push(t),s=n;continue}const[o,a]=vt(e,s,!1);r.push(o),s=a}return[r,s]}function xt(e){const[t]=Nt(e,1);return t}function Tt(e){return`{${e.map((e=>Array.isArray(e)?Tt(e):"string"==typeof e?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`)).join(",")}}`}class Ot extends bt{foreignKeyConfigs=[];static[e]="PgColumnBuilder";array(e){return new $t(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map((({ref:r,actions:s})=>function(e,...t){return e(...t)}(((r,s)=>{const n=new wt((()=>{const t=r();return{columns:[e],foreignColumns:[t]}}));return s.onUpdate&&n.onUpdate(s.onUpdate),s.onDelete&&n.onDelete(s.onDelete),n.build(t)}),r,s)))}}class jt extends y{constructor(e,t){t.uniqueName||(t.uniqueName=function(e,t){return`${e[w.Symbol.Name]}_${t.join("_")}_unique`}(e,[t.name])),super(e,t),this.table=e}static[e]="PgColumn"}class $t extends Ot{static[e]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){const t=this.config.baseBuilder.build(e);return new Et(e,this.config,t)}}class Et extends jt{constructor(e,t,r,s){super(e,t),this.baseColumn=r,this.range=s,this.size=t.size}size;static[e]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=xt(e)),e.map((e=>this.baseColumn.mapFromDriverValue(e)))}mapToDriverValue(e,r=!1){const s=e.map((e=>null===e?null:t(this.baseColumn,Et)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e)));return r?s:Tt(s)}}class At extends Ot{static[e]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ct(e,this.config)}}class Ct extends jt{static[e]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}class qt extends jt{static[e]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{return e}return e}}class Qt extends Ot{static[e]="PgDateColumnBaseBuilder";defaultNow(){return this.default(P`now()`)}}class _t extends Qt{static[e]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new Pt(e,this.config)}}class Pt extends jt{static[e]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${void 0===this.precision?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>this.withTimezone?e.toUTCString():e.toISOString()}class Lt extends Qt{static[e]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new Rt(e,this.config)}}class Rt extends jt{static[e]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${void 0===this.precision?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}const Bt=function(e,t,r,s,n=e){const i=new Ee(e,s,n),o=Object.fromEntries(Object.entries(t).map((([e,t])=>{const r=t,s=r.build(i);return i[$e].push(...r.buildForeignKeys(s,i)),[e,s]}))),a=Object.assign(i,o);return a[m.Symbol.Columns]=o,r&&(a[Ee.Symbol.ExtraConfigBuilder]=r),a}("user_preferences",{account_id:function(e,t={}){return new At("account_id",t)}().notNull().primaryKey(),preferences:("preferences",new class extends Ot{static[e]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new qt(e,this.config)}}("preferences")).notNull(),last_update_datetime:function(e,t={}){return"string"===t.mode?new Lt(e,t.withTimezone??!1,t.precision):new _t(e,t.withTimezone??!1,t.precision)}("last_update_datetime").notNull()},void 0);const kt=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map((e=>[e.name,e])),Dt=new Map(kt);Error;const zt=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Ft=new WeakSet,It=({from:e,seen:t,to:r,forceEnumerable:s,maxDepth:n,depth:i,useToJSON:o,serialize:a})=>{if(r||(r=Array.isArray(e)?[]:!a&&Mt(e)?new((e=>Dt.get(e)??Error)(e.name)):{}),t.push(e),i>=n)return r;if(o&&"function"==typeof e.toJSON&&!Ft.has(e))return(e=>{Ft.add(e);const t=e.toJSON();return Ft.delete(e),t})(e);const l=e=>It({from:e,seen:[...t],forceEnumerable:s,maxDepth:n,depth:i,useToJSON:o,serialize:a});for(const[s,n]of Object.entries(e))if(n&&n instanceof Uint8Array&&"Buffer"===n.constructor.name)r[s]="[object Buffer]";else if(null===n||"object"!=typeof n||"function"!=typeof n.pipe){if("function"!=typeof n)if(n&&"object"==typeof n)t.includes(e[s])?r[s]="[Circular]":(i++,r[s]=l(e[s]));else try{r[s]=n}catch{}}else r[s]="[object Stream]";for(const{property:t,enumerable:n}of zt)void 0!==e[t]&&null!==e[t]&&Object.defineProperty(r,t,{value:Mt(e[t])?l(e[t]):e[t],enumerable:!!s||n,configurable:!0,writable:!0});return r};function Mt(e){return Boolean(e)&&"object"==typeof e&&"name"in e&&"message"in e&&"stack"in e}var Ut=r(208);const Kt={async fetch(e,t,r){try{const r=new Ut("gcploggingproject-427121",t.GCP_LOGGING_CREDENTIALS),s="my-log",n="ERROR",i="This is a log message.";return r.logEntry(s,n,i),await async function(e,t,r){var s=e.headers.get("Origin")||e.headers.get("origin");if("OPTIONS"===e.method){const r=await t.CORS_DOMAINS.split(",");var n=!1;for(var i in r)new RegExp(r[i]).test(s)&&(n=!0);return n?new Response("",{status:204,headers:{"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Origin":s,"Access-Control-Allow-Methods":"POST, GET, OPTIONS, DELETE, PUT","Access-Control-Allow-Headers":"Authorization, Content-Type, Identity",Connection:e.headers.get("Connection")}}):new Response(JSON.stringify({message:"CORS Not supported -> "+s}),{status:403,headers:{"Content-Type":"application/json"}})}if("GET"===new String(e.method).valueOf().toUpperCase())return new String(e.url.substring(e.url.lastIndexOf("/")+1)).valueOf()===new String(t.INITIALIZATION_KEY).valueOf()?(await async function(e){console.log("Initializing database");const t=gt(e.user_prefs_database);try{await t.select().from(Bt).where(z(Bt.account_id,0))}catch(t){await e.user_prefs_database.prepare("CREATE TABLE user_preferences (\n        account_id varchar(64) PRIMARY KEY,\n        preferences jsonb,\n        last_update_datetime timestamp)").run()}return"initialization complete"}(t),new Response("",{status:200,headers:{"Content-Type":"application/json"}})):new Response("",{status:403,headers:{"Content-Type":"application/json"}});var o="";if(null==e.headers.get("Authorization")&&null==e.headers.get("authorization"))return new Response(JSON.stringify({message:"Authorization header not found."}),{status:403,headers:{"Content-Type":"application/json"}});null!=e.headers.get("Authorization")&&e.headers.get("Authorization").startsWith("Bearer ")?o=e.headers.get("Authorization").split(" ")[1]:null!=e.headers.get("authorization")&&e.headers.get("authorization").startsWith("Bearer ")&&(o=e.headers.get("authorization").split(" ")[1]);var a={"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Origin":s,"Access-Control-Allow-Methods":"POST, GET, OPTIONS, DELETE, PUT","Access-Control-Allow-Headers":"Authorization, Content-Type, Identity",Connection:e.headers.get("Connection"),"Content-Type":"application/json"};const l="https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token="+o;var c=await fetch(l,{method:"GET",headers:{"Content-Type":"application/json"}}),u=JSON.parse(await c.text());if(null==u||null==u.id)return new Response(JSON.stringify({message:"Account not found / token invalid."}),{status:403,headers:{"Content-Type":"application/json"}});var h={};switch(e.method){case"GET":h=await yt(t,u.id,e.headers.get("Identity"));break;case"PUT":var f=await e.json();h=await async function(e,t,r){var s=await yt(e,t);if("account_id"in s){const o=gt(e.user_prefs_database);var n=JSON.parse(s.preferences.preferences);for(var i of Object.keys(r))n[i]=r[i];return await o.update(user_preferences).set({preferences:n,last_update_datetime:new Date}).where(z(user_preferences.account_id,t)).run(),yt(e,t)}return{}}(t,u.id,f,e.headers.get("Identity"));break;case"POST":f=await e.json(),h=await async function(e,t){return{}}(0,u.id,e.headers.get("Identity"));break;case"DELETE":h=await async function(e,t){return{}}(0,u.id,e.headers.get("Identity"))}return new Response(JSON.stringify(h),{status:200,headers:a})}(e,t)}catch(e){const t=function(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:s=!0}=t;return"object"==typeof e&&null!==e?It({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:s,serialize:!0}):"function"==typeof e?`[Function: ${e.name||"anonymous"}]`:e}(e);return new Response(JSON.stringify(t),{status:500,headers:{"Content-Type":"application/json"}})}}}})();var n=s.c;export{n as default};